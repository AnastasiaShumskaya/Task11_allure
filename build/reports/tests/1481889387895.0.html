<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
    <title>RMSys - Office</title>
    <meta content="IE=10" http-equiv="X-UA-Compatible" />
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <script src="/Scripts/RMSys/RedirectRouting.js"></script>

    <link rel="stylesheet" href="/Content/css/jquery-custom-theme/jquery-ui-1.8.21.custom.css" />
<link rel="stylesheet" href="/Content/css/rmsys/Master.css" />
<link rel="stylesheet" href="/Content/css/rmsys/Site.css" />
<link rel="stylesheet" href="/Content/css/rmsys/Feedback.css" />
<link rel="stylesheet" href="/Content/css/rmsys/FormPopup.css" />
<link rel="stylesheet" href="/Content/css/rmsys/DropDownList.css" />
<link rel="stylesheet" href="/Content/css/rmsys/Spinner.css" />
<link rel="stylesheet" href="/Content/css/rmsys/SelectorControl.css" />
<link rel="stylesheet" href="/Content/css/jquery-custom-theme/ui.datepicker.css" />

    <script src="/Scripts/jquery-1.9.1.js"></script>
<script src="/Scripts/jquery-ui.js"></script>
<script src="/Scripts/migrateScript.js"></script>
<script src="/Scripts/jquery.textshadow.js"></script>
<script src="/Scripts/RMSys/CheckBrowser.js"></script>

    <script src="/Scripts/jquery.unobtrusive-ajax.js"></script>
<script src="/Scripts/jquery.validate.js"></script>
<script src="/Scripts/jquery.validate.unobtrusive.js"></script>

    <script src="/Scripts/RMSys/helpers.js"></script>
<script src="/Scripts/RMSys/dateHelpers.js"></script>
<script src="/Scripts/RMSys/Feedback.js"></script>
<script src="/Scripts/RMSys/Extensions.js"></script>
<script src="/Scripts/RMSys/DropDownList.js"></script>
<script src="/Scripts/RMSys/controls/selector-control.js"></script>

    <script src="/Scripts/RMSys/Tooltip.js"></script>

    <script src="/Scripts/RMSys/AutentificationError.js"></script>

    <script src="/Scripts/knockout-2.2.1.debug.js"></script>
<script src="/Scripts/knockout.mapping-latest.debug.js"></script>

    <script src="/Scripts/RMSys/controls/custom-multiselect.js"></script>

    <script src="/Scripts/RMSys/custom-dropdown/jquery.selectbox-0.2.js"></script>
<script src="/Scripts/RMSys/custom-dropdown/jquery.selectbox-0.2.extensions.js"></script>


    <link rel="stylesheet" href="/Content/css/custom-dropdown/jquery.selectbox.css" />

    <link rel="stylesheet" href="/Content/css/rmsys/Tooltip.css" />

    <link rel="stylesheet" href="/Content/css/controls/custom-multiselect.css" />


     
    <link rel="stylesheet" href="/Content/css/rmsys/Common.css" />
<link rel="stylesheet" href="/Content/css/rmsys/ViewTabs.css" />

    <link rel="stylesheet" href="/Content/css/rmsys/PageHeader.css" />

    <link rel="stylesheet" href="/Content/css/plugins/ui.jqgrid.css" />
<link rel="stylesheet" href="/Content/css/rmsys/GridHeader.css" />
<link rel="stylesheet" href="/Content/css/rmsys/CustomGrid.css" />

    <link rel="stylesheet" href="/Content/css/rmsys/Office.css" />
<link rel="stylesheet" href="/Content/css/rmsys/OfficeManagement.css" />

    <link rel="stylesheet" href="/Content/css/rmsys/OfficePopup.css" />

	<link rel="stylesheet" href="/Content/css/rmsys/PageHeader.css" />

    <link rel="stylesheet" href="/Content/css/rmsys/listView.css" />

    <link rel="stylesheet" href="/Content/css/rmsys/PullDownList.css" />
<link rel="stylesheet" href="/Content/css/rmsys/Reveal.css" />

	<script src="/Scripts/jQuery.download.js"></script>

    <script src="/Scripts/i18n/grid.locale-en.js"></script>
<script src="/Scripts/jquery.jqGrid.src.js"></script>
<script src="/Scripts/RMSys/grid/global-var.js"></script>
<script src="/Scripts/RMSys/grid/grid-pager.js"></script>
<script src="/Scripts/RMSys/grid/grid-column-settings.js"></script>
<script src="/Scripts/RMSys/grid/grid-common.js"></script>
<script src="/Scripts/RMSys/grid/FilterDescriptionFunc.js"></script>
<script src="/Scripts/RMSys/grid/TimeFilterFunc.js"></script>

	<script src="/Scripts/RMSys/OfficeManagement.js"></script>

    <script src="/Scripts/RMSys/page-common.js"></script>
<script src="/Scripts/RMSys/Overlay.js"></script>
<script src="/Scripts/RMSys/Spinner.js"></script>
<script src="/Scripts/RMSys/PageTimeFilter.js"></script>
<script src="/Scripts/RMSys/grid/global-var.js"></script>

    <script src="/Scripts/RMSys/SendTo.js"></script>



    <script type="text/javascript">
        // temporary disabled until rmsys mobile is fully ready
        //setupRedirectToMobile('https://192.168.100.26:11119');
    </script>
</head>
<body>

    <div class="main" id="main_div">
        <div class="top" id="divMenu">
            <div class="top-center-menu">
                <div class="welcome-message">
                    Welcome,
                    <span id="username-settings">
                        Anastasia
                        <a href="/Individual/IndividualProfile?loginName=AnastasiaShumskaya">My Profile</a>
                    </span>
                </div>
                <div id="welcomeDivContent">
                    <div class="menu-links">
                        <span class="send-feedback-message"><a title="Send feedback" href="/"><ins>Feedback</ins></a></span><span class="menu-link-separator">|</span>
                        <span><a title="Send mail" href="mailto:rmsys@cosol.com"><ins>Contact Us</ins></a></span><span class="menu-link-separator">|</span>
                        <span class="sign-out-span"><a title="Sign out" href="/"><ins>Sign Out</ins></a></span>
                    </div>
                </div>
            </div>
            
            
            <div class="top-center-div-tabs">
                <div class="top-center">
                    <div class="tabs-menu">




    <div class="menu-left-float">

        <a id="homeMenu" href="/Home/Index"> Home</a>
        <span onclick="location.href='/Home/Index'"><span class="count"></span></span>
    </div>

    <div class="menu-left-float">

        <a id="individualMenu" href="/Individual/Index"> Individual</a>
        <span onclick="location.href='/Individual/Index'"><span class="count">673</span></span>
    </div>

    <div class="menu-left-float">

        <a id="clientMenu" href="/Client/Index"> Client</a>
        <span onclick="location.href='/Client/Index'"><span class="count">71</span></span>
    </div>

    <div class="menu-left-float">

        <a id="projectMenu" href="/Project/Index"> Project</a>
        <span onclick="location.href='/Project/Index'"><span class="count">165</span></span>
    </div>

    <div class="menu-left-float">

        <a id="skillMenu" href="/SkillExplorer/Index"> Skill Explorer</a>
        <span onclick="location.href='/SkillExplorer/Index'"><span class="count"></span></span>
    </div>

    <div class="menu-left-float tab-active">

        <a id="officeMenu" href="/Office/Index"> Office</a>
        <span onclick="location.href='/Office/Index'"><span class="count">27</span></span>
    </div>

    <div class="menu-left-float">

        <a id="companyMenu" href="/Company/Index"> Company</a>
        <span onclick="location.href='/Company/Index'"><span class="count">2</span></span>
    </div>




    <div class="menu-left-float">

        <a id="vacationMenu" href="/VacationRequest/Index"> Vacation</a>
        <span onclick="location.href='/VacationRequest/Index'"><span class="count"></span></span>
    </div>




                    </div>
                </div>
            </div>
        </div>
        


<link rel="stylesheet" href="/Content/css/jquery-custom-theme/ui.datepicker.css" />

<script src="/Scripts/RMSys/DataPicker.js"></script>
<script src="/Scripts/RMSys/DatepickerYear.js"></script>

<script src="/Scripts/RMSys/ToolBar.js"></script>


<div style="" class="toolbar-border-top toolbar-header" id="toolbar-6f38d500-3e8f-4846-9766-ee5da9b6a0bc">
    <div class="toolbar-header-content" id="toolbar-header-content">

            <div class="search-container" id="search-container">
                <input value="" class="input-search" id="input-search" />
                <button title="Search" class="search-icon search-button" id="search-button">
                </button>
                <button title="Clear" id="delete-icon" class="delete-icon delete-icon-search-container">
                </button>
            </div>  
            <div class="container-divider">
        </div>
        
                <select tabindex="1" id="column-filter" class="column-filter" sb="33181689" style="display: none;">
                            <option selected="selected">Office Name</option>
                            <option>Room</option>
                            <option>Desk</option>
                            <option>Workplace Assigned</option>
                </select><div id="sbHolder_33181689" class="sbHolder" tabindex="1"><a id="sbToggle_33181689" href="#" class="sbToggle"></a><a id="sbSelector_33181689" href="#" class="sbSelector">Sort by: Office Name</a><ul id="sbOptions_33181689" class="sbOptions" style="display: none;"><li><a href="#Office%20Name" rel="Office Name" class="sbFocus">Office Name</a></li><li><a href="#Room" rel="Room">Room</a></li><li><a href="#Desk" rel="Desk">Desk</a></li><li><a href="#Workplace%20Assigned" rel="Workplace Assigned">Workplace Assigned</a></li></ul></div>

        


    </div>
</div>
<script type="text/javascript">
    var toolbar = new customToolbar();
    toolbar.initialize('6f38d500-3e8f-4846-9766-ee5da9b6a0bc', '/EditOffice/Edit', '/EditOffice/Delete', 'Search by office', '12/16/2016');
    $("#toolbar-6f38d500-3e8f-4846-9766-ee5da9b6a0bc").show(); // display toolbar after initialization
</script>

<script type="text/javascript" src="/Scripts/RMSys/UrlHashHelper.js"></script>
<link rel="stylesheet" href="/Content/css/rmsys/IndividualShow.css" />


<div id="list-view">
    <div id="left-container">
        
<link rel="stylesheet" href="/Content/css/rmsys/Spinner.css" />


<div class="spinner-container">
    <img alt="spinner" src="../../Content/images/common/spinner.gif" id="spinner" />
</div>
        <div class="rmsys-skin" id="list-items-container">
            <ul id="list-items"></ul>
        </div>
    </div>
    <div id="right-container"><div style="display: none;" class="vacation-list-spinner-container spinner-container">
            <img alt="spinner" src="../../Content/images/common/spinner.gif" id="spinner" />
        </div>
        <div class="hide-list-of-vacations" id="list-item-details">

        </div>
    </div>
    <div class="clear">
    </div>
</div>

<script type="text/javascript">
    var hashHelper;
    var queryCounter = 0;
    var leftContainer = $("#left-container");
    var rightContainer = $("#right-container");
    var listView = $("#list-view");



    function SelectFirstItem() {
        SelectItem($("#list-items").children("li").first().attr("id"));
    }

    var RIGHTCONTAINERMINWIDTH = 1156;
    var LEFTCONTAINERMINWIDTH = 137;

    function ListCorrection() {
        rightContainer.width(listView.width() - leftContainer.width() - 1);
    }

    function SetupSplitter() {

        var widthQuotient = localStorage.getItem("WidthQuotient");

        if (widthQuotient == null) {
            widthQuotient = 2;
        }

        leftContainer.width(0);
        rightContainer.width(0);
        var lvWidth = Math.floor(listView.width());
        var priorWidth = Math.floor(lvWidth / widthQuotient);
        leftContainer.width(priorWidth);

        rightContainer.width(lvWidth - priorWidth - 1);
    }
    
    function ResizeConatainers(quotient) {
        var lvWidth = listView.width() - 1;
        leftContainer.width(0);
        rightContainer.width(0);

        var x = $(".individual-assignments-content.individual-assignments-content-enable-scroll").get(0);

        if (x) {
            RIGHTCONTAINERMINWIDTH = x.scrollHeight &gt; $(x).height() ? 1120 : 1100;
        }

        leftContainer.resizable("option", "maxWidth", lvWidth - RIGHTCONTAINERMINWIDTH);

        //Determine left container width
        var priorWidth = Math.floor(lvWidth / quotient);

        if (priorWidth &lt; LEFTCONTAINERMINWIDTH) {
            leftContainer.width(LEFTCONTAINERMINWIDTH);
        } else {
            if (priorWidth &gt; (lvWidth - RIGHTCONTAINERMINWIDTH)) {
                leftContainer.width(lvWidth - RIGHTCONTAINERMINWIDTH);
            } else {
                leftContainer.width(priorWidth);
            }
        }

        //Determine right container width
        priorWidth = lvWidth - leftContainer.width();

        if (priorWidth &lt; RIGHTCONTAINERMINWIDTH) {
            rightContainer.width(RIGHTCONTAINERMINWIDTH);
        } else {
            rightContainer.width(priorWidth);
        }

        InitializeDetailsContainerScroll();
    }

    $().ready(function () {
        var summaryFilter = {
            QuickSearch: '',
            SortColumn: 'Office Name',
            Date: '12/16/2016',
            TimeFilter: 'Active &amp;amp; Future',
            GridFilters: null,
            SortOrder: 'ASC',
            VacationStatusFilter: 'Pending,Approved,In Progress,Completed,Declined,No Vacation'
        };
        hashHelper = new UrlHashHelper('');

        var hashId = hashHelper.GetIdFromHash();
        if (hashId) {
            summaryFilter.ActiveItemId = hashId;
            summaryFilter.QuickSearch = null;
            toolbar.ClearSearchValue();
        }

        GetData(summaryFilter, true, undefined, true);

        MoveListView();

        SetupSplitter();

        var quotient = 2;
        var initialLvSize = listView.width() - 1;
        var a = 0;

        leftContainer.resizable({
            handles: 'e',
            minWidth: LEFTCONTAINERMINWIDTH,

            start: function () {
                initialLvSize = listView.width() - 1;
            },
            resize: function () {
                //it's necessary two times assign rightContainer width. First we prevents scroll showing, after we set correct width
                rightContainer.width(initialLvSize - leftContainer.width() - 20);
                //Chrome v 30 bug. Without this right container may move down
                a = listView.width();
                rightContainer.width(rightContainer.width() + 20);
            },
            stop: function () {
                var lwWidth = listView.width() - 1;
                ListCorrection();

                quotient = lwWidth / leftContainer.width();
                localStorage.setItem("WidthQuotient", quotient);
            }
        });

        leftContainer.resizable("option", "maxWidth", (listView.width() - 1) - RIGHTCONTAINERMINWIDTH);

        ResizeConatainers(quotient);

        $(window).resize(function (e) {
            //check wheter listView is still in the DOM
            if (e.target === window &amp;&amp; listView.closest('body').length &gt; 0) {
                ResizeConatainers(quotient);
            }
        });
    });


    $("#expandButton").click(function () {
        MoveListView();
    });

    //set absolute positioned list-view top because of collapsed element
    function MoveListView() {
        var header = $('.toolbar-header');
        if (header.length == 0) {
            header = $('#list-view').prevAll('div:first').first();
        }
        if (header) {

            var headerHeight = header.position().top + header.outerHeight();

            if ((window.navigator.appName.indexOf("Explorer", 0) != -1)) {
                headerHeight = headerHeight + 1;

            }
            $('#list-view').css('top', headerHeight + 'px');
        }
        InitializeDetailsContainerScroll();
    }

    function InitializeDetailsContainerScroll() {
        var listViewHeight = listView.height();
        var primaryInfoHeight = $("#list-view .primary-info").height();
        var tabsHeight = 33;
        $("#list-view .detailInfo").height(listViewHeight - primaryInfoHeight - tabsHeight);
    }


    function InitializeListViewClick2() {
        $("#list-items &gt; li").click(function () {
            SelectItem(this.getAttribute("id"), true);
        });

        $("#list-items &gt; li").dblclick(function () {
            var itemId = this.getAttribute("id");
            ShowDetailsPopup(
                        '#list-details-popup-container',
                        '#left-container',
                        '&lt;div id="list-details-popup-container"&gt;&lt;/div&gt;',
                        '/Office/Show?id=' + itemId + '&amp;fromPopUp=true'
                     );
        });
    }

    function GetData(summaryFilter, checkRedirect, newItemId, getIdFromHash) {
        //think about universal spinner placing
        $.ajax({
            type: 'GET',
            url: '/Office/Summary',
            data: summaryFilter,
            success: function (result) {
                $(".spinner-container").hide();
                if ('/Office/Summary' == '/Client/Summary' &amp;&amp; typeof result != 'string')
                    result = "";

                $("#list-item-details").empty();
                var listItems = $("#list-items");

                // This is hack for IE, because it renders huge number of elements with markup jump.
                // You can notice it when filter is set to show all individuals.
                if ((window.navigator.appName.indexOf("Explorer", 0) != -1)) {
                    listItems.css("display", "none");
                    listItems.html(result);
                    setTimeout(function () {
                        listItems.css("display", "block");
                    }, 1);
                } else {
                    listItems.html(result);
                }

                setCountToMainTab($('#list-items').children("li").length);

                if ($("#list-items").children("li").length &gt; 0 || getIdFromHash) {
                    EnableCUDButtons();

                    if (checkRedirect) {
                        hashHelper.CheckRedirect();
                    }
                    if (newItemId != undefined) {
                        SelectItem(newItemId);
                    }
                    else {
                        var activeItemId = getIdFromHash ? hashHelper.GetIdFromHash() : hashHelper.GetId();
                        if (activeItemId != '') {
                            SelectItem(activeItemId);
                        } else {
                            SelectFirstItem();
                        }
                    }

                    InitializeListViewClick2();

                    if ($.connection != undefined) {

                        $.connection.hub.start({ transport: ['webSockets', 'serverSentEvents', 'longPolling'] }).done(function () {
                            summaryFilter.GridFilters = jQuery.parseJSON(summaryFilter.GridFilters);
                            summaryFilter.VacationStatusFilter = null;
                            var filter = new Object;
                            filter.Date = summaryFilter.Date;
                            filter.GridFilters = summaryFilter.GridFilters;
                            filter.QuickSearch = summaryFilter.QuickSearch;
                            filter.SortColumn = summaryFilter.SortColumn;
                            filter.SortOrder = summaryFilter.SortOrder;
                            filter.VacationStatusFilter = summaryFilter.VacationStatusFilter;

                            // Page Time Filter can be changed from initial to ALL
                            filter.TimeFilter = PageTimeFilterClass.GetPageTimeFilter();

                            var IDs = [];
                            $('.person-record:lt(20)').each(function () { IDs.push(this.id); });
                            image.server.sendImages(filter, IDs);
                        });
                    }
                }
                else {
                    ShowListWithoutItems();
                    DisableCUDButtons();
                }
            }
        });
    }

    function SelectItem(selectedItemId, skipScroll) {
        var inList = $("#" + selectedItemId).length != 0;
        if ($(".selected").attr("id") == selectedItemId) return;
        $(".selected").removeClass("selected");
        if (!inList) {
            selectedItemId = $("#list-items").children("li").first().attr("id");
        } 
        $("#" + selectedItemId).addClass("selected");
        $(".hide-list-of-vacations").empty();
        $('.vacation-list-spinner-container').css('display', 'block');
        queryCounter++;
        $.ajax({
            type: 'GET',
            cache: true,
            data: { id: selectedItemId },
            url: '/Office/Show',
            success: function (result) {
                queryCounter--;
                if (queryCounter != 0) {
                    return
                }

                if ($(result).find('#error-message').text().indexOf('Invalid Guid') &gt;= 0) {
                    SelectFirstItem();
                    return;
                }

                $('.vacation-list-spinner-container').css('display', 'none');
                $("#list-item-details").html(result);

                //For IE
                if (false || !!document.documentMode) {
                    $("#requestHover").css("margin-right", "0px");
                }

                var tabId = $("#list-item-details .tabs-view").attr('id');
                hashHelper.InitializeTab(tabId);
                hashHelper.SetId(selectedItemId);

                if (!skipScroll &amp;&amp; inList) {
                    var scroll = $('#list-items-container').scrollTop() + $('#' + selectedItemId).position().top;
                    $('#list-items-container').animate({ scrollTop: scroll }, 'slow');
                }
            }
        });
    }

    function DisableCUDButtons() {
        if ($("#add-button").length != 0) $("#add-button").prop("disabled", true);
        if ($("#edit-button").length != 0) $("#edit-button").prop("disabled", true);
        if ($("#delete-button").length != 0) $("#delete-button").prop("disabled", true);

        if ($("#add-button-vacation").length != 0) $("#add-button-vacation").prop("disabled", true);
        if ($("#admin-button-edit").length != 0) $("#admin-button-edit").prop("disabled", true);
        if ($("#admin-button-delete").length != 0) $("#admin-button-delete").prop("disabled", true);
    }

    function EnableCUDButtons() {
        if ($("#add-button").length != 0) $("#add-button").prop("disabled", false);
        if ($("#edit-button").length != 0) $("#edit-button").prop("disabled", false);
        if ($("#delete-button").length != 0) $("#delete-button").prop("disabled", false);

        if ($("#add-button-vacation").length != 0) $("#add-button-vacation").prop("disabled", false);
        if ($("#admin-button-edit").length != 0) $("#admin-button-edit").prop("disabled", false);
        if ($("#admin-button-delete").length != 0) $("#admin-button-delete").prop("disabled", false);
    }

    function ShowListWithoutItems() {
        //If you want to show something for empty list override this function
    }
</script>

    <div id="containment-wrapper">
    </div>

<script type="text/javascript">

    $(function () {
        setSortFieldSize();
    });

    $("#officeMenu").parent(".menu-left-float").addClass("tab-active");

    function CustomAddNewItem() {
        toolbar.ShowPopup('/EditOffice/Add', undefined, 'Add New Office');
        return;
    }

    function setSortFieldSize() {
        $(".sbSelector").addClass("sbOfficeHolderSelector");
        $(".sbHolder").addClass("sbOfficeHolderSelector");
    }

</script>

    </div>
    <div class="formEditor">
    </div>
    <div class="feedbackFormEditor">
    </div>

    <script type="text/javascript">
        


        AllowFeedbackButton();

        //TODO: Please find file to me and put me into it
        function setCountToMainTab(numberOfRecords) {
            var mainTabSelectedLinkId = $('a', ".menu-left-float.tab-active").attr('id');
            if (mainTabSelectedLinkId &amp;&amp; mainTabSelectedLinkId.toString() !== 'vacationMenu') {
                $(".count", ".menu-left-float.tab-active").text(numberOfRecords);
                $(".count", ".menu-left-float.tab-active").css("visibility", "visible");
            } else {
               
            }
        }

        function setCountToSubTab(tabHeaderSelector, count) {
            var countSpan = $(tabHeaderSelector + ' span.number');
            countSpan.text(count);
            countSpan.textShadow();
        }


        function setCountToSubTabjQuery(jQueryObj, count) {
            jQueryObj.text(count);
            jQueryObj.textShadow();
        }

        //hack for IE to support text-shadow.

        $(function () {
            $('.menu-left-float a ,.menu-left-float.tab-active a, .grid-header-content-text-ie-shadow').textShadow();
            $('.tabText').textShadow({ignoreEmptyTextShadow : true});
        });
    </script>


</body></html>